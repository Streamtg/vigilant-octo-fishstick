name: Simulate Human Interaction with Matrix

on:
  schedule:
    - cron: '0 */12 * * *' # Ejecuta cada 12 horas
  workflow_dispatch: # Permite ejecución manual

jobs:
  simulate-interaction:
    runs-on: ubuntu-latest
    timeout-minutes: 2
    strategy:
      max-parallel: 20
      fail-fast: false
      matrix:
        go: [1.0, 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.1, 2.2]
        flag: [A, B, C, D, E, F, G, H, I, J, K, L, M, N, Ñ, O, P, Q]
    steps:
      # 1. Configurar Node.js
      - name: Set up Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'

      # 2. Instalar Puppeteer
      - name: Install Puppeteer
        run: npm install puppeteer

      # 3. Ejecutar script de simulación con Puppeteer
      - name: Run Puppeteer Script
        run: |
          node -e "
          const puppeteer = require('puppeteer');
          (async () => {
            const browser = await puppeteer.launch({ 
              headless: true, 
              args: ['--no-sandbox', '--disable-setuid-sandbox'] 
            });
            const page = await browser.newPage();
            await page.setViewport({ width: 1280, height: 800 });
            await page.setUserAgent('Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36');
            await page.goto('https://yoelmod.blogspot.com/2022/05/netflix-premium-free-mod-apk.html', { waitUntil: 'networkidle2' });

            // Generar un tiempo aleatorio entre 60 y 90 segundos
            const minTime = 60 * 1000; // 60 segundos en milisegundos
            const maxTime = 90 * 1000; // 90 segundos en milisegundos
            const randomTime = Math.floor(Math.random() * (maxTime - minTime + 1)) + minTime;

            // Registrar el tiempo de inicio
            const startTime = Date.now();

            // Simular acciones mientras no se cumpla el tiempo
            while (Date.now() - startTime < randomTime) {
              await page.evaluate(() => window.scrollBy(0, window.innerHeight)); // Scroll hacia abajo
              await page.waitForTimeout(2000); // Espera 2 segundos entre acciones
            }

            // Cerrar el navegador al finalizar
            await browser.close();
          })();"
