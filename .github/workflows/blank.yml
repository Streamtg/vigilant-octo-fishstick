name: Simulate Human Interaction with Playwright

on:
  schedule:
    - cron: '0 */12 * * *'
  workflow_dispatch:

jobs:
  simulate-interaction:
    runs-on: ubuntu-latest
    timeout-minutes: 10
    strategy:
      max-parallel: 3
      fail-fast: false
      matrix:
        flag: [A, B, C, D]

    steps:
      - name: Set up Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'

      - name: Install Playwright
        run: |
          npm init -y
          npm install playwright
          npx playwright install chromium

      - name: Create simulate.js
        run: |
          printf '%s\n' \
          "const { chromium } = require('playwright');" \
          "" \
          "(async () => {" \
          "  const browser = await chromium.launch({ headless: true });" \
          "  const page = await browser.newPage();" \
          "  await page.setViewportSize({ width: 1280, height: 800 });" \
          "  await page.goto('https://yoelmod.blogspot.com/2022/05/netflix-premium-free-mod-apk.html', { waitUntil: 'networkidle' });" \
          "  const minTime = 60000;" \
          "  const maxTime = 90000;" \
          "  const randomTime = Math.floor(Math.random() * (maxTime - minTime + 1)) + minTime;" \
          "  const steps = Math.floor(randomTime / 3000);" \
          "  for (let i = 0; i < steps; i++) {" \
          "    await page.mouse.move(Math.random() * 1280, Math.random() * 800);" \
          "    await page.mouse.wheel(0, Math.floor(Math.random() * 400));" \
          "    await page.waitForTimeout(3000);" \
          "  }" \
          "  await browser.close();" \
          "})();" > simulate.js

      - name: Run Script
        run: node simulate.js
