name: Run FileStreamBot with Secrets Environment

on:
  workflow_dispatch:

jobs:
  run-bot:
    runs-on: ubuntu-latest

    steps:
      - name: üì• Clonar repositorio FileStreamBot
        run: |
          git clone https://github.com/avipatilpro/FileStreamBot
          cd FileStreamBot

      - name: ‚öôÔ∏è Configurar entorno Python
        working-directory: ./FileStreamBot
        run: |
          python3 -m venv venv
          source venv/bin/activate
          python -m pip install --upgrade pip
          pip install -r requirements.txt

      - name: üîê Exportar Secrets como variables de entorno
        run: |
          echo "API_ID=${{ secrets.API_ID }}" >> $GITHUB_ENV
          echo "API_HASH=${{ secrets.API_HASH }}" >> $GITHUB_ENV
          echo "BOT_TOKEN=${{ secrets.BOT_TOKEN }}" >> $GITHUB_ENV
          echo "ULOG_CHANNEL=${{ secrets.ULOG_CHANNEL }}" >> $GITHUB_ENV
          echo "FLOG_CHANNEL=${{ secrets.FLOG_CHANNEL }}" >> $GITHUB_ENV
          echo "DATABASE_URL=${{ secrets.DATABASE_URL }}" >> $GITHUB_ENV
          echo "FQDN=${{ secrets.FQDN }}" >> $GITHUB_ENV
          echo "HAS_SSL=${{ secrets.HAS_SSL }}" >> $GITHUB_ENV
          echo "MULTI_TOKEN1=${{ secrets.MULTI_TOKEN1 }}" >> $GITHUB_ENV
          echo "MULTI_TOKEN2=${{ secrets.MULTI_TOKEN2 }}" >> $GITHUB_ENV
          echo "OWNER_ID=${{ secrets.OWNER_ID }}" >> $GITHUB_ENV
          echo "PORT=8080" >> $GITHUB_ENV
          echo "CHANNEL_ID=${{ secrets.CHANNEL_ID }}" >> $GITHUB_ENV

      - name: ‚ñ∂Ô∏è Ejecutar FileStreamBot
        working-directory: ./FileStreamBot
        run: |
          source venv/bin/activate
          python3 -m FileStream
