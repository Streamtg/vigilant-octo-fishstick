name: Blog Traffic Simulator

on:
  workflow_dispatch:
  schedule:
    - cron: "0 * * * *"  # Corre cada hora

jobs:
  simulate-visits:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Install Dependencies
        run: |
          sudo apt update
          sudo apt install -y curl jq

      - name: Visit Blog without Proxy
        run: |
          # Obtener todos los enlaces del blog principal
          URLS=$(curl -s https://yoelmod.blogspot.com | grep -oP '(?<=href=")[^"]+' | grep '^https://yoelmod.blogspot.com' | sort -u)
          echo "$URLS" > urls.txt
          
          # Seleccionar 5 URLs aleatorios
          RANDOM_URLS=$(shuf -n 5 urls.txt)

          for URL in $RANDOM_URLS; do
            echo "Visitando $URL sin proxy"
            curl -A "$(shuf -n 1 -e \
              'Mozilla/5.0 (Windows NT 10.0; Win64; x64)' \
              'Mozilla/5.0 (Linux; Android 11)' \
              'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7)')" \
              -e "https://www.google.com" -L "$URL" \
              --connect-timeout 10 --max-time 25 || echo "Fallo al visitar $URL"
          done
